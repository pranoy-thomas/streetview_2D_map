(function(){"use strict";var e={324:function(e,t,o){var a=o(547),s=o(149);const i={id:"app"},n={class:"app-main"},r={class:"app-container"},c={class:"map-section"},l={class:"sidebar"};function d(e,t,o,a,d,h){const p=(0,s.g2)("MapComponent"),u=(0,s.g2)("AddressCapture"),m=(0,s.g2)("LocationHistory");return(0,s.uX)(),(0,s.CE)("div",i,[t[0]||(t[0]=(0,s.Lk)("header",{class:"app-header"},[(0,s.Lk)("h1",null,"StreetView 2D Map"),(0,s.Lk)("p",null,"Select locations on the map and save their addresses")],-1)),(0,s.Lk)("main",n,[(0,s.Lk)("div",r,[(0,s.Lk)("div",c,[(0,s.bF)(p)]),(0,s.Lk)("div",l,[(0,s.bF)(u),(0,s.bF)(m)])])])])}var h=o(949);const p={class:"map-container"},u={ref:"map",class:"map"},m={key:0,class:"loading-overlay"},L={key:1,class:"loading-overlay"},g={key:2,class:"error-overlay"},v={class:"error-message"},y={key:3,class:"location-info-overlay"},k={class:"location-info"},f={class:"map-controls"};function M(e,t,o,a,i,n){return(0,s.uX)(),(0,s.CE)("div",p,[(0,s.Lk)("div",u,null,512),e.loading?((0,s.uX)(),(0,s.CE)("div",m,[...t[2]||(t[2]=[(0,s.Lk)("div",{class:"spinner"},null,-1)])])):(0,s.Q3)("",!0),i.reverseGeocodingLoading?((0,s.uX)(),(0,s.CE)("div",L,[...t[3]||(t[3]=[(0,s.Lk)("div",{class:"spinner"},null,-1)])])):(0,s.Q3)("",!0),e.error?((0,s.uX)(),(0,s.CE)("div",g,[(0,s.Lk)("div",v,(0,h.v_)(e.error),1)])):(0,s.Q3)("",!0),e.selectedLocation?((0,s.uX)(),(0,s.CE)("div",y,[(0,s.Lk)("div",k,[t[6]||(t[6]=(0,s.Lk)("h4",null,"Selected Location",-1)),(0,s.Lk)("p",null,[t[4]||(t[4]=(0,s.Lk)("strong",null,"Coordinates:",-1)),(0,s.eW)(" "+(0,h.v_)(e.selectedLocation.latitude.toFixed(6))+", "+(0,h.v_)(e.selectedLocation.longitude.toFixed(6)),1)]),(0,s.Lk)("p",null,[t[5]||(t[5]=(0,s.Lk)("strong",null,"Address:",-1)),(0,s.eW)(" "+(0,h.v_)(e.selectedLocation.address),1)]),(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>n.clearSelection&&n.clearSelection(...e)),class:"btn-clear"},"Clear Selection")])])):(0,s.Q3)("",!0),(0,s.Lk)("div",f,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>n.refreshLocations&&n.refreshLocations(...e)),class:"btn-control"},"Refresh Locations")])])}var E=o(541),w=o.n(E),C=o(797),_=o(726),S=o(786),A=o(338),O=o(925);delete w().Icon.Default.prototype._getIconUrl,w().Icon.Default.mergeOptions({iconUrl:C,iconRetinaUrl:_,shadowUrl:S,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]});var b={name:"MapComponent",data(){return{map:null,rawMap:null,markers:{},reverseGeocodingLoading:!1,isDestroying:!1,reverseGeocodeUrl:"https://nominatim.openstreetmap.org/reverse"}},computed:{...(0,A.aH)(["loading","error","mapCenter","mapZoom","isMapReady","selectedLocation","locations"])},methods:{...(0,A.i0)(["setMapReady","selectLocation","clearSelectedLocation","setMapCenter","setMapZoom","fetchLocations"]),async initMap(){try{if(!this.$refs.map)return void console.error("Map element not found in DOM");this.map=w().map(this.$refs.map,{zoomAnimation:!1,fadeAnimation:!1}).setView(this.mapCenter,this.mapZoom),this.rawMap=(0,O.ux)(this.map),w().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19}).addTo(this.rawMap),this.rawMap.on("click",this.handleMapClick),this.rawMap.on("zoomend",this.onZoomEnd),this.addLocationMarker(),this.addExistingLocationMarkers(),this.setMapReady(),this.$watch(()=>this.locations,()=>{this.updateLocationMarkers()},{deep:!0})}catch(e){console.error("Error initializing map:",e),this.clearSelectedLocation()}},destroyMap(){this.rawMap&&(this.rawMap.off("click",this.handleMapClick),this.rawMap.off("zoomend",this.onZoomEnd),this.rawMap.stop(),this.rawMap.remove(),this.map=null,this.rawMap=null)},onZoomEnd(){if(!this.isDestroying&&this.rawMap&&this.rawMap.getContainer()&&this.rawMap){const e=this.rawMap.getCenter(),t=this.rawMap.getZoom();this.setMapCenter([e.lat,e.lng]),this.setMapZoom(t)}},async handleMapClick(e){if(!this.rawMap||this.isDestroying||!this.rawMap.getContainer())return;const{lat:t,lng:o}=e.latlng;this.reverseGeocodingLoading=!0;try{const e=await this.reverseGeocode(t,o),a={latitude:t,longitude:o,address:e,temporary:!0};this.selectLocation(a),this.rawMap&&!this.isDestroying&&this.rawMap.getContainer()&&this.addLocationMarker()}catch(a){console.error("Reverse geocoding failed:",a);const e={latitude:t,longitude:o,address:`(${t.toFixed(6)}, ${o.toFixed(6)})`,temporary:!0};this.selectLocation(e),this.rawMap&&!this.isDestroying&&this.rawMap.getContainer()&&this.addLocationMarker()}finally{this.reverseGeocodingLoading=!1}},async reverseGeocode(e,t){try{const o=await fetch(`${this.reverseGeocodeUrl}?format=json&lat=${e}&lon=${t}&addressdetails=1`),a=await o.json();if(a&&a.display_name)return a.display_name;throw new Error("No address found")}catch(o){throw console.warn("Reverse geocoding failed:",o),o}},addLocationMarker(){if(this.rawMap&&!this.isDestroying&&this.rawMap.getContainer()){if(this.markers.temporary){try{this.rawMap.hasLayer(this.markers.temporary)&&this.rawMap.removeLayer(this.markers.temporary)}catch(e){console.warn("Error removing temporary marker:",e)}delete this.markers.temporary}if(this.selectedLocation&&this.selectedLocation.temporary)try{const e=w().icon({iconUrl:C,iconRetinaUrl:_,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowUrl:S,shadowSize:[41,41],shadowAnchor:[12,41]}),t=w().marker([this.selectedLocation.latitude,this.selectedLocation.longitude],{icon:e}).addTo(this.rawMap).bindPopup(`<b>Selected Location</b><br>${this.selectedLocation.address}`).openPopup();this.markers.temporary=t,this.rawMap&&!this.isDestroying&&this.rawMap.getContainer()&&this.rawMap.setView([this.selectedLocation.latitude,this.selectedLocation.longitude],15)}catch(e){console.warn("Error adding temporary marker:",e)}}},addExistingLocationMarkers(){if(!this.rawMap||this.isDestroying||!this.rawMap.getContainer())return;Object.keys(this.markers).forEach(e=>{if("temporary"!==e&&this.markers[e])try{this.rawMap.hasLayer(this.markers[e])&&this.rawMap.removeLayer(this.markers[e])}catch(t){console.warn("Error removing marker:",t)}});const e=this.markers.temporary;this.markers={},e&&(this.markers.temporary=e),this.locations.forEach(e=>{if(e.id&&!this.markers[`location_${e.id}`])try{const t=w().icon({iconUrl:C,iconRetinaUrl:_,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowUrl:S,shadowSize:[41,41],shadowAnchor:[12,41]}),o=w().marker([e.latitude,e.longitude],{icon:t}).addTo(this.rawMap).bindPopup(`<b>Saved Location</b><br>${e.address}<br><small>ID: ${e.id}</small>`).on("click",()=>{this.selectLocation(e)});this.markers[`location_${e.id}`]=o}catch(t){console.warn("Error adding location marker:",t)}})},updateLocationMarkers(){this.addExistingLocationMarkers()},centerOnDefault(){this.rawMap&&!this.isDestroying&&this.rawMap.getContainer()&&this.rawMap.setView(this.mapCenter,this.mapZoom)},refreshLocations(){this.fetchLocations().catch(e=>{console.error("Failed to refresh locations:",e)})},clearSelection(){if(this.clearSelectedLocation(),this.rawMap&&!this.isDestroying&&this.rawMap.getContainer()&&this.markers.temporary){try{this.rawMap.hasLayer(this.markers.temporary)&&this.rawMap.removeLayer(this.markers.temporary)}catch(e){console.warn("Error removing temporary marker:",e)}delete this.markers.temporary}}},mounted(){this.$refs.map?this.initMap():console.error("Map element not found in DOM")},beforeUnmount(){if(this.isDestroying=!0,this.rawMap)try{this.rawMap.stop(),this.rawMap.off("click",this.handleMapClick),this.rawMap.off("zoomend",this.onZoomEnd),this.rawMap.eachLayer(e=>{this.rawMap.removeLayer(e)});const e=this.rawMap.getContainer();e&&e.parentNode&&this.rawMap.remove()}catch(e){console.warn("Error during map cleanup:",e)}finally{this.map=null,this.rawMap=null}}},T=o(890);const R=(0,T.A)(b,[["render",M],["__scopeId","data-v-5606c36c"]]);var D=R;const I={class:"address-capture"},N={key:0,class:"selected-location"},X={class:"location-details"},$=["disabled"],x={class:"capture-actions"},Z=["disabled"],U={key:0},F={key:1},z=["disabled"],G={key:1,class:"no-selection"},P={key:2,class:"success-message"},j={key:3,class:"error-message"};function Q(e,t,o,i,n,r){return(0,s.uX)(),(0,s.CE)("div",I,[t[6]||(t[6]=(0,s.Lk)("h3",null,"Capture Location",-1)),e.selectedLocation?((0,s.uX)(),(0,s.CE)("div",N,[(0,s.Lk)("div",X,[t[3]||(t[3]=(0,s.Lk)("p",null,[(0,s.Lk)("strong",null,"Coordinates:")],-1)),(0,s.Lk)("p",null,(0,h.v_)(e.selectedLocation.latitude.toFixed(6))+", "+(0,h.v_)(e.selectedLocation.longitude.toFixed(6)),1),t[4]||(t[4]=(0,s.Lk)("p",null,[(0,s.Lk)("strong",null,"Address:")],-1)),(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.addressInput=e),placeholder:"Enter address details...",disabled:e.loading,class:"address-input"},null,8,$),[[a.Jo,n.addressInput]])]),(0,s.Lk)("div",x,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>r.saveLocation&&r.saveLocation(...e)),disabled:e.loading||!n.addressInput.trim(),class:"btn-save"},[e.loading?((0,s.uX)(),(0,s.CE)("span",U,"Saving...")):((0,s.uX)(),(0,s.CE)("span",F,"Save Location"))],8,Z),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>r.clearSelection&&r.clearSelection(...e)),disabled:e.loading,class:"btn-cancel"}," Cancel ",8,z)])])):((0,s.uX)(),(0,s.CE)("div",G,[...t[5]||(t[5]=[(0,s.Lk)("p",null,"Select a location on the map to capture its address",-1)])])),n.successMessage?((0,s.uX)(),(0,s.CE)("div",P,(0,h.v_)(n.successMessage),1)):(0,s.Q3)("",!0),e.error?((0,s.uX)(),(0,s.CE)("div",j,(0,h.v_)(e.error),1)):(0,s.Q3)("",!0)])}var V={name:"AddressCapture",data(){return{addressInput:"",successMessage:""}},computed:{...(0,A.aH)(["selectedLocation","loading","error"])},watch:{selectedLocation:{immediate:!0,handler(e){e?this.addressInput=e.address||"":(this.addressInput="",this.successMessage="")}}},methods:{...(0,A.i0)(["addLocation","clearSelectedLocation"]),async saveLocation(){if(this.addressInput.trim())try{const e={latitude:this.selectedLocation.latitude,longitude:this.selectedLocation.longitude,address:this.addressInput.trim()};await this.addLocation(e),this.successMessage="Location saved successfully!",setTimeout(()=>{this.clearSelection()},2e3)}catch(e){console.error("Error saving location:",e),this.successMessage=""}else this.successMessage=""},clearSelection(){this.clearSelectedLocation(),this.addressInput="",this.successMessage=""}}};const H=(0,T.A)(V,[["render",Q],["__scopeId","data-v-0448b808"]]);var J=H;const W={class:"location-history"},Y={class:"history-header"},B={class:"history-stats"},K={key:0,class:"loading"},q={key:1,class:"no-locations"},ee={key:2,class:"locations-list"},te=["onClick"],oe={class:"location-coords"},ae={class:"coords"},se={class:"location-address"},ie={class:"address"},ne={class:"timestamp"},re={class:"location-actions"},ce=["onClick"],le={key:3,class:"modal-overlay"},de={class:"edit-modal"},he={class:"edit-form"},pe={class:"modal-actions"},ue={key:4,class:"success-message"},me={key:5,class:"error-message"};function Le(e,t,o,i,n,r){return(0,s.uX)(),(0,s.CE)("div",W,[(0,s.Lk)("div",Y,[t[3]||(t[3]=(0,s.Lk)("h3",null,"Previously Selected Locations",-1)),(0,s.Lk)("div",B,[(0,s.Lk)("span",null,"Total: "+(0,h.v_)(e.locations.length),1)])]),e.loading?((0,s.uX)(),(0,s.CE)("div",K,[...t[4]||(t[4]=[(0,s.Lk)("p",null,"Loading locations...",-1)])])):0===e.locations.length?((0,s.uX)(),(0,s.CE)("div",q,[...t[5]||(t[5]=[(0,s.Lk)("p",null,"No locations saved yet.",-1),(0,s.Lk)("p",null,"Select locations on the map to see them here.",-1)])])):((0,s.uX)(),(0,s.CE)("div",ee,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.locations,e=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,class:(0,h.C4)(["location-item",{"selected-location":r.isSelected(e)}])},[(0,s.Lk)("div",{class:"location-content",onClick:t=>r.viewLocation(e)},[(0,s.Lk)("div",oe,[(0,s.Lk)("span",ae,(0,h.v_)(e.latitude.toFixed(6))+", "+(0,h.v_)(e.longitude.toFixed(6)),1)]),(0,s.Lk)("div",se,[(0,s.Lk)("p",ie,(0,h.v_)(e.address),1),(0,s.Lk)("small",ne,(0,h.v_)(r.formatDate(e.created_at)),1)])],8,te),(0,s.Lk)("div",re,[(0,s.Lk)("button",{onClick:(0,a.D$)(t=>r.deleteLocation(e.id),["stop"]),class:"btn-delete",title:"Delete location"}," ðŸ—‘ï¸ ",8,ce)])],2))),128))])),n.editingLocation?((0,s.uX)(),(0,s.CE)("div",le,[(0,s.Lk)("div",de,[t[7]||(t[7]=(0,s.Lk)("h4",null,"Edit Location",-1)),(0,s.Lk)("div",he,[t[6]||(t[6]=(0,s.Lk)("label",null,"Address:",-1)),(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.editAddress=e),class:"edit-address-input",placeholder:"Enter address details..."},null,512),[[a.Jo,n.editAddress]])]),(0,s.Lk)("div",pe,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>r.saveEditedLocation&&r.saveEditedLocation(...e)),class:"btn-save"},"Save"),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>r.cancelEdit&&r.cancelEdit(...e)),class:"btn-cancel"},"Cancel")])])])):(0,s.Q3)("",!0),n.successMessage?((0,s.uX)(),(0,s.CE)("div",ue,(0,h.v_)(n.successMessage),1)):(0,s.Q3)("",!0),e.error?((0,s.uX)(),(0,s.CE)("div",me,(0,h.v_)(e.error),1)):(0,s.Q3)("",!0)])}var ge={name:"LocationHistory",data(){return{editingLocation:null,editAddress:"",successMessage:""}},computed:{...(0,A.aH)(["locations","loading","error","selectedLocation"])},methods:{...(0,A.i0)(["deleteLocation","selectLocation","setMapCenter","setMapZoom","fetchLocations"]),isSelected(e){return this.selectedLocation&&this.selectedLocation.id===e.id},viewLocation(e){this.selectLocation(e),this.setMapCenter([e.latitude,e.longitude]),this.setMapZoom(15)},selectForEditing(e){this.editingLocation=e,this.editAddress=e.address},async saveEditedLocation(){this.successMessage="Location updated successfully!",this.editingLocation=null,this.editAddress="",await this.fetchLocations(),setTimeout(()=>{this.successMessage=""},3e3)},cancelEdit(){this.editingLocation=null,this.editAddress=""},async deleteLocation(e){if(confirm("Are you sure you want to delete this location?"))try{await this.$store.dispatch("deleteLocation",e),this.successMessage="Location deleted successfully!",this.selectedLocation&&this.selectedLocation.id===e&&this.selectLocation(null),setTimeout(()=>{this.successMessage=""},3e3)}catch(t){console.error("Error deleting location:",t)}},formatDate(e){if(!e)return"Just now";const t=new Date(e);return t.toLocaleString()}}};const ve=(0,T.A)(ge,[["render",Le],["__scopeId","data-v-13edd710"]]);var ye=ve,ke={name:"App",components:{MapComponent:D,AddressCapture:J,LocationHistory:ye},mounted(){this.$store.dispatch("fetchLocations").catch(e=>{console.error("Failed to fetch locations:",e)})}};const fe=(0,T.A)(ke,[["render",d]]);var Me=fe,Ee=o(605);const we="http://localhost:3000/api";var Ce=(0,A.y$)({state:{locations:[],selectedLocation:null,loading:!1,error:null,mapCenter:[-33.8688,151.2093],mapZoom:13,isMapReady:!1},mutations:{SET_LOCATIONS(e,t){e.locations=t},ADD_LOCATION(e,t){e.locations.unshift(t)},REMOVE_LOCATION(e,t){e.locations=e.locations.filter(e=>e.id!==t)},SET_SELECTED_LOCATION(e,t){e.selectedLocation=t},SET_LOADING(e,t){e.loading=t},SET_ERROR(e,t){e.error=t},SET_MAP_CENTER(e,t){e.mapCenter=t},SET_MAP_ZOOM(e,t){e.mapZoom=t},SET_MAP_READY(e,t){e.isMapReady=t},CLEAR_ERROR(e){e.error=null}},actions:{async fetchLocations({commit:e}){e("SET_LOADING",!0),e("CLEAR_ERROR");try{const t=await Ee.A.get(`${we}/locations`);return e("SET_LOCATIONS",t.data.data),t.data}catch(t){const o=t.response?.data?.error||t.message;throw e("SET_ERROR",o),t}finally{e("SET_LOADING",!1)}},async addLocation({commit:e},t){e("SET_LOADING",!0),e("CLEAR_ERROR");try{const o=await Ee.A.post(`${we}/locations`,t);return e("ADD_LOCATION",o.data.data),e("SET_SELECTED_LOCATION",o.data.data),o.data}catch(o){const t=o.response?.data?.error||o.message;throw e("SET_ERROR",t),o}finally{e("SET_LOADING",!1)}},async deleteLocation({commit:e},t){e("SET_LOADING",!0),e("CLEAR_ERROR");try{return await Ee.A.delete(`${we}/locations/${t}`),e("REMOVE_LOCATION",t),{success:!0,message:"Location deleted successfully"}}catch(o){const t=o.response?.data?.error||o.message;throw e("SET_ERROR",t),o}finally{e("SET_LOADING",!1)}},selectLocation({commit:e},t){e("SET_SELECTED_LOCATION",t)},clearSelectedLocation({commit:e}){e("SET_SELECTED_LOCATION",null)},setMapCenter({commit:e},t){e("SET_MAP_CENTER",t)},setMapZoom({commit:e},t){e("SET_MAP_ZOOM",t)},setMapReady({commit:e}){e("SET_MAP_READY",!0)}},getters:{allLocations:e=>e.locations,selectedLocation:e=>e.selectedLocation,loading:e=>e.loading,error:e=>e.error,mapCenter:e=>e.mapCenter,mapZoom:e=>e.mapZoom,isMapReady:e=>e.isMapReady,locationCount:e=>e.locations.length,recentLocations:e=>e.locations.slice(0,10),getLocationById:e=>t=>e.locations.find(e=>e.id===t)}});delete w().Icon.Default.prototype._getIconUrl,w().Icon.Default.mergeOptions({iconUrl:C,iconRetinaUrl:_,shadowUrl:S,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]});const _e=(0,a.Ef)(Me);_e.use(Ce),_e.mount("#app"),console.log("StreetView 2D Map application initialized")}},t={};function o(a){var s=t[a];if(void 0!==s)return s.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,o),i.exports}o.m=e,function(){var e=[];o.O=function(t,a,s,i){if(!a){var n=1/0;for(d=0;d<e.length;d++){a=e[d][0],s=e[d][1],i=e[d][2];for(var r=!0,c=0;c<a.length;c++)(!1&i||n>=i)&&Object.keys(o.O).every(function(e){return o.O[e](a[c])})?a.splice(c--,1):(r=!1,i<n&&(n=i));if(r){e.splice(d--,1);var l=s();void 0!==l&&(t=l)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[a,s,i]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,a){var s,i,n=a[0],r=a[1],c=a[2],l=0;if(n.some(function(t){return 0!==e[t]})){for(s in r)o.o(r,s)&&(o.m[s]=r[s]);if(c)var d=c(o)}for(t&&t(a);l<n.length;l++)i=n[l],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(d)},a=self["webpackChunkstreetview_client"]=self["webpackChunkstreetview_client"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=o.O(void 0,[504],function(){return o(324)});a=o.O(a)})();
//# sourceMappingURL=app.b9f8df56.js.map